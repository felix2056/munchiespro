(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{789:function(e,t,a){"use strict";a.r(t);var r=a(0),s=a(1),n=(a(13),a(24),a(29),a(28),a(7),a(72),a(40),a(139),a(71),a(92),a(502)),i=a(2),u=a.n(i),o=a(16),c={components:{DefaultLayout:function(){return Promise.all([a.e(3),a.e(0),a.e(1),a.e(2),a.e(51)]).then(a.bind(null,258))},MapControls:n.a},beforeRouteUpdate:function(e,t,a){this.fetchData({to:e,from:t}),a()},data:function(){return{zones:"10,11",isMounted:!1,pageNumber:0}},computed:Object(s.a)(Object(s.a)({},Object(o.c)(["ssrPageLoaded","mediaMatch"])),{},{fullWidthHeader:function(){var e;return!(null===(e=this.$route)||void 0===e||!e.meta.fullWidthHeader)},isMobileListingPage:function(){return this.fullWidthHeader&&this.isMobile},isMobile:function(){return"sm"===this.mediaMatch||"xs"===this.mediaMatch}}),mounted:function(){this.isMounted=!0,this.fetchData({to:this.$route})},methods:Object(s.a)(Object(s.a)(Object(s.a)({},Object(o.b)("city",["SET","NEXT_PAGE"])),Object(o.b)(["newGet","setSsrPageLoad"])),{},{fetchData:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function a(){var r,s,n,i,o,c,l;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.to,s=e.from,"null"!==r.params.city){a.next=4;break}return t.$store.commit("setError",{status:301,redirect:"/"}),a.abrupt("return");case 4:if(!r||t.ssrPageLoaded!==r.fullPath||!t.isMounted){a.next=7;break}return t.$store.commit("setSsrPageLoad",!0),a.abrupt("return");case 7:return n="cities/",i={},(o=t.scrubFilters({to:r}))&&(i.filters=o),"cityDeals"===r.name||"cityDealsWithFilters"===r.name?(n+="deals/",i.page=t.pageNumber):"cityIndex"!==r.name&&(n+="businesses/"),r.params.state&&(n+="".concat(r.params.state,"/")),n+=r.params.city,"cityGuide"===r.name&&(n="guides/city/".concat(r.params.city),i.filters=null,i.state=r.params.state||null),"cityIndex"!==r.name&&"cityGuide"!==r.name||(i.zones=t.zones),r.params.page&&void 0!==r.params.page&&(i.page=r.params.page),c={endpoint:n,params:i},a.next=20,t.newGet(c);case 20:if((l=a.sent).data&&!0===l.data.success)if(s&&r.name===s.name&&r.params.page>s.params.page)t.NEXT_PAGE(l.data.results);else if(t.SET({data:l.data.results,currentUrl:r.fullPath}),s&&r.params.page<s.params.page)try{document.querySelector("#business-list").scrollTop=0}catch(e){u.a.notify(e)}return a.abrupt("return",l);case 23:case"end":return a.stop()}}),a)})))()},scrubFilters:function(e){var t=e.to,a=t.fullPath&&t.fullPath.substring(1).replace(/\/|\+/g,",").split(","),r=[],s=r.filter((function(e){return null!=e}));return this.pageNumber=parseInt(a[a.length-1]),isNaN(this.pageNumber)?this.pageNumber=1:a.pop(),!(a.length<1)&&(r.push(t.params.city,t.params.state,"marijuana-dispensary-deals",String(t.params.page)),!((a=a.filter((function(e){return s.indexOf(e)<0}))).length<1)&&a.join(","))}}),serverPrefetch:function(){return this.$store.commit("setSsrPageLoad",this.$route.fullPath),this.fetchData({to:this.$route})}},l=a(12),p=Object(l.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("DefaultLayout",{attrs:{"full-width-header":e.fullWidthHeader},scopedSlots:e._u([e.isMobileListingPage?{key:"mobile-map-controls",fn:function(){return[a("map-controls")]},proxy:!0}:null],null,!0)},[a("router-view",{attrs:{id:"city-shell"}})],1)}),[],!1,null,null,null);t.default=p.exports}}]);
//# sourceMappingURL=cityShell.3b47da3ab1ffd00f368f.js.map